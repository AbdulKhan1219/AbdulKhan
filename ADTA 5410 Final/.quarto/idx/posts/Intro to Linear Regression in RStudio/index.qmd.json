{"title":"Intro to Linear Regression in RStudio","markdown":{"yaml":{"title":"Intro to Linear Regression in RStudio","author":"Abdul Khan","date":"2023-12-04","categories":["R","regression","code","analysis"],"image":"image.jpg"},"headingText":"Run this code chunk without altering it","containsRefs":false,"markdown":"\n\nHello, to begin the Linear Regression in RStudio we first have to load in the libraries we will be using for this example. With the code block provided below it will import all the necessary libraries.\n\n```{r, echo=TRUE, message=FALSE, warning=FALSE}\nlibrary(knitr)\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(rpart)\nlibrary(rsample)\nlibrary(caret)\nlibrary(mgcv)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n\nThe data that we will be using in this example will be from 2004 North Carolina Birth Records. In the dataset we are trying to determine if there is any relationship between the behaviours of pregnant women and the outcome of their childbirth.\n\n```{r, echo=TRUE, warning=FALSE, message=FALSE}\n# clear the session\nrm(list=ls())\n\n# Data is stored in a csv file, the first row contains the variable names. \n# we call our data mydata\nmydata<-read.csv (\"Data_RLab5.csv\", header=TRUE)\n\n# remove lowbirthweight\nmydata<-mydata%>%\n  select(-lowbirthweight)\n```\n\nRun the following code block above to remove some necessary variables we will not be taking into consideration in our analysis.\n\n```{r, echo=TRUE}\n\n#With the below code we will be examining the variable descriptions and the overall structure of the dataset\nstr(mydata)\n\n#The next step is to find any missing values within the dataset so we will run the following code to determine what is missing\nmissing_values <- colSums(is.na(mydata))\n\n\n#In this step we are replacing the missing values, for numeric variables we fill the missing values with the median, for categorical variables we use the mode to replace the missing values\nfor (col in names(mydata)) {\n  if (is.numeric(mydata[[col]])) {\n    mydata[[col]][is.na(mydata[[col]])] <- median(mydata[[col]], na.rm = TRUE)\n  } else {\n    mode_val <- names(sort(table(mydata[[col]]), decreasing = TRUE))[1]\n    mydata[[col]][is.na(mydata[[col]])] <- mode_val\n  }\n}\n\n#In this step  we are are going to exclude all non-nomerical variables in order to calculate our highest correlations with the target variables\nnumeric_vars <- sapply(mydata, is.numeric)\ncorrelations <- cor(mydata[, numeric_vars])\n\ntarget_corr <- correlations[,\"weight\"]\nmax_corr_var <- names(target_corr[which.max(abs(target_corr))])\n\nlibrary(ggplot2)\n\n#With the below code block we are building a scatter plot \nggplot(mydata, aes(x = mydata[[max_corr_var]], y = weight)) +\n  geom_point() +\n  labs(title = paste(\"Scatter Plot\", max_corr_var, \"vs. Weight\"),\n       x = max_corr_var,\n       y = \"Weight\")\n```\n\nThe scatter plot illustrates the connection between the variable 'gained'---indicating the mother's weight gain during pregnancy---and the target variable 'weight', which is the baby's birth weight. This relationship is the most correlated in the dataset.\n\nKey Points:\n\nLinear Correlation: The plot demonstrates a notably strong linear correlation between the mother's weight gain ('gained') and the baby's birth weight ('weight'). A higher weight gain by the mother generally corresponds to an increased birth weight of the baby.\n\nPositive Trend: There's a positive trend observable in the plot, signifying a direct relationship where more weight gain during pregnancy relates to a heavier birth weight. This supports the usual belief linking maternal weight gain to the baby's birth weight.\n\nPresence of Outliers: Some points on the plot stray from the primary trend, reflecting variations in the relationship. These could result from individual health differences, genetic influences, or personal lifestyle factors.\n\nIndication of a Linear Model: The scatter plot suggests a straight-line relation, indicative of a linear connection. Nevertheless, it's crucial to recognize that while the trend appears linear, the actual relationship might not be entirely straight. Exploring different models might be beneficial to account for possible non-linear aspects.\n\nTo sum up, the scatter plot sheds light on how the weight gained during pregnancy impacts the baby's birth weight. Further examination, like applying regression analysis, can offer a more detailed and accurate understanding of this relationship.\n\n```{r, echo=TRUE}\n# split the sample by using rsample package\n\n# Split the data into a training set (70%) and a test set (30%)\nset.seed(123456)\n# Set seed for reproducibility\nset.seed(123456)\n\n\n# Use initial_split to divide the data\nsplit_data <- initial_split(mydata, prop = 0.7, strata = \"weight\")\n\n# Create training and test sets\ntrain_data <- training(split_data)\ntest_data <- testing(split_data)\n\n\n```\n\n```{r, echo=TRUE}\n# Please provide your code for Task 3  in this code chunk\n# Run linear regression on the training data\nlinearmodel <- lm(weight ~ ., data = train_data)\n\n# Predict weight in the test_data dataset\npredicted_weights_ols <- predict(linearmodel, newdata = test_data)\n\n# Calculate Mean Squared Prediction Error (MSPE)\nMSPE_linear <- mean((predicted_weights_ols - test_data$weight)^2)\n\n# Print the value of MSPE_linear to the console\nprint(MSPE_linear)\n\n```\n\n```{r, echo=TRUE}\n#We will import another library for our analysis\nlibrary(mgcv)\n\n# Fit a GAM on the training data\ngam_model <- gam(weight ~ s(fage) + s(mage) + s(weeks) + s(visits) + s(gained), data = train_data, method = \"REML\")\n\n# Print smoothing parameters\nsummary(gam_model)$s.table\n\n# Predict weight in the test_data dataset using gam_model\npredicted_weights_gam <- predict(gam_model, newdata = test_data)\n\n# Calculate MSPE\nMSPE_gam <- mean((predicted_weights_gam - test_data$weight)^2)\n\n# Print the value of MSPE_gam to the console\nprint(MSPE_gam)\n\n\n```\n\n```{r, echo=TRUE}\n\nMSPE_linear <- mean((predicted_weights_ols - test_data$weight)^2)\n\nMSPE_gam <- mean((predicted_weights_gam - test_data$weight)^2)\n\ncat(\"Linear Regression Model MSPE:\", MSPE_linear, \"\\n\")\ncat(\"Generalized Additive Model MSPE:\", MSPE_gam, \"\\n\")\n\n\nif (MSPE_linear < MSPE_gam) {\n  cat(\"Conclusion: Linear Regression Model better performing based on MSPE.\\n\")\n} else if (MSPE_gam < MSPE_linear) {\n  cat(\"Conclusion: Generalized Additive Model better performing based on MSPE.\\n\")\n} else {\n  cat(\"Conclusion: Both models performance are equal based on MSPE.\\n\")\n}\n```\n\nThe Mean Squared Prediction Errors (MSPE) were assessed for both the linear regression model (referred to as linearmodel) and the generalized additive model (referred to as gam_model), utilizing the test_data dataset.\n\nCalculated MSPE Values:\n\nMSPE for Linear Model: 1.133044 #MSPE for GAM: 1.159198 #Analysis:\n\nThe linear regression model exhibits a lower MSPE in comparison to the generalized additive model. To be precise, the MSPE for the linear model is 1.133044, whereas for the GAM it is 1.159198.\n\nConclusion:\n\nGiven its lower MSPE, the linear regression model (linearmodel) shows better prediction accuracy for the 'weight' variable within the test_data dataset. Hence, based on the MSPE metric, the linear model is the more suitable choice in this particular scenario.\n\nHowever, it is important to remember that evaluating models typically involves multiple criteria, and the selection of the most appropriate model may vary based on the specific objectives and the nature of the data involved.\n\nWith this blog post we have a given insight in how to preform a Linear Regression in RStudio\n","srcMarkdownNoYaml":"\n\nHello, to begin the Linear Regression in RStudio we first have to load in the libraries we will be using for this example. With the code block provided below it will import all the necessary libraries.\n\n```{r, echo=TRUE, message=FALSE, warning=FALSE}\nlibrary(knitr)\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(rpart)\nlibrary(rsample)\nlibrary(caret)\nlibrary(mgcv)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n\nThe data that we will be using in this example will be from 2004 North Carolina Birth Records. In the dataset we are trying to determine if there is any relationship between the behaviours of pregnant women and the outcome of their childbirth.\n\n```{r, echo=TRUE, warning=FALSE, message=FALSE}\n# Run this code chunk without altering it\n# clear the session\nrm(list=ls())\n\n# Data is stored in a csv file, the first row contains the variable names. \n# we call our data mydata\nmydata<-read.csv (\"Data_RLab5.csv\", header=TRUE)\n\n# remove lowbirthweight\nmydata<-mydata%>%\n  select(-lowbirthweight)\n```\n\nRun the following code block above to remove some necessary variables we will not be taking into consideration in our analysis.\n\n```{r, echo=TRUE}\n\n#With the below code we will be examining the variable descriptions and the overall structure of the dataset\nstr(mydata)\n\n#The next step is to find any missing values within the dataset so we will run the following code to determine what is missing\nmissing_values <- colSums(is.na(mydata))\n\n\n#In this step we are replacing the missing values, for numeric variables we fill the missing values with the median, for categorical variables we use the mode to replace the missing values\nfor (col in names(mydata)) {\n  if (is.numeric(mydata[[col]])) {\n    mydata[[col]][is.na(mydata[[col]])] <- median(mydata[[col]], na.rm = TRUE)\n  } else {\n    mode_val <- names(sort(table(mydata[[col]]), decreasing = TRUE))[1]\n    mydata[[col]][is.na(mydata[[col]])] <- mode_val\n  }\n}\n\n#In this step  we are are going to exclude all non-nomerical variables in order to calculate our highest correlations with the target variables\nnumeric_vars <- sapply(mydata, is.numeric)\ncorrelations <- cor(mydata[, numeric_vars])\n\ntarget_corr <- correlations[,\"weight\"]\nmax_corr_var <- names(target_corr[which.max(abs(target_corr))])\n\nlibrary(ggplot2)\n\n#With the below code block we are building a scatter plot \nggplot(mydata, aes(x = mydata[[max_corr_var]], y = weight)) +\n  geom_point() +\n  labs(title = paste(\"Scatter Plot\", max_corr_var, \"vs. Weight\"),\n       x = max_corr_var,\n       y = \"Weight\")\n```\n\nThe scatter plot illustrates the connection between the variable 'gained'---indicating the mother's weight gain during pregnancy---and the target variable 'weight', which is the baby's birth weight. This relationship is the most correlated in the dataset.\n\nKey Points:\n\nLinear Correlation: The plot demonstrates a notably strong linear correlation between the mother's weight gain ('gained') and the baby's birth weight ('weight'). A higher weight gain by the mother generally corresponds to an increased birth weight of the baby.\n\nPositive Trend: There's a positive trend observable in the plot, signifying a direct relationship where more weight gain during pregnancy relates to a heavier birth weight. This supports the usual belief linking maternal weight gain to the baby's birth weight.\n\nPresence of Outliers: Some points on the plot stray from the primary trend, reflecting variations in the relationship. These could result from individual health differences, genetic influences, or personal lifestyle factors.\n\nIndication of a Linear Model: The scatter plot suggests a straight-line relation, indicative of a linear connection. Nevertheless, it's crucial to recognize that while the trend appears linear, the actual relationship might not be entirely straight. Exploring different models might be beneficial to account for possible non-linear aspects.\n\nTo sum up, the scatter plot sheds light on how the weight gained during pregnancy impacts the baby's birth weight. Further examination, like applying regression analysis, can offer a more detailed and accurate understanding of this relationship.\n\n```{r, echo=TRUE}\n# split the sample by using rsample package\n\n# Split the data into a training set (70%) and a test set (30%)\nset.seed(123456)\n# Set seed for reproducibility\nset.seed(123456)\n\n\n# Use initial_split to divide the data\nsplit_data <- initial_split(mydata, prop = 0.7, strata = \"weight\")\n\n# Create training and test sets\ntrain_data <- training(split_data)\ntest_data <- testing(split_data)\n\n\n```\n\n```{r, echo=TRUE}\n# Please provide your code for Task 3  in this code chunk\n# Run linear regression on the training data\nlinearmodel <- lm(weight ~ ., data = train_data)\n\n# Predict weight in the test_data dataset\npredicted_weights_ols <- predict(linearmodel, newdata = test_data)\n\n# Calculate Mean Squared Prediction Error (MSPE)\nMSPE_linear <- mean((predicted_weights_ols - test_data$weight)^2)\n\n# Print the value of MSPE_linear to the console\nprint(MSPE_linear)\n\n```\n\n```{r, echo=TRUE}\n#We will import another library for our analysis\nlibrary(mgcv)\n\n# Fit a GAM on the training data\ngam_model <- gam(weight ~ s(fage) + s(mage) + s(weeks) + s(visits) + s(gained), data = train_data, method = \"REML\")\n\n# Print smoothing parameters\nsummary(gam_model)$s.table\n\n# Predict weight in the test_data dataset using gam_model\npredicted_weights_gam <- predict(gam_model, newdata = test_data)\n\n# Calculate MSPE\nMSPE_gam <- mean((predicted_weights_gam - test_data$weight)^2)\n\n# Print the value of MSPE_gam to the console\nprint(MSPE_gam)\n\n\n```\n\n```{r, echo=TRUE}\n\nMSPE_linear <- mean((predicted_weights_ols - test_data$weight)^2)\n\nMSPE_gam <- mean((predicted_weights_gam - test_data$weight)^2)\n\ncat(\"Linear Regression Model MSPE:\", MSPE_linear, \"\\n\")\ncat(\"Generalized Additive Model MSPE:\", MSPE_gam, \"\\n\")\n\n\nif (MSPE_linear < MSPE_gam) {\n  cat(\"Conclusion: Linear Regression Model better performing based on MSPE.\\n\")\n} else if (MSPE_gam < MSPE_linear) {\n  cat(\"Conclusion: Generalized Additive Model better performing based on MSPE.\\n\")\n} else {\n  cat(\"Conclusion: Both models performance are equal based on MSPE.\\n\")\n}\n```\n\nThe Mean Squared Prediction Errors (MSPE) were assessed for both the linear regression model (referred to as linearmodel) and the generalized additive model (referred to as gam_model), utilizing the test_data dataset.\n\nCalculated MSPE Values:\n\nMSPE for Linear Model: 1.133044 #MSPE for GAM: 1.159198 #Analysis:\n\nThe linear regression model exhibits a lower MSPE in comparison to the generalized additive model. To be precise, the MSPE for the linear model is 1.133044, whereas for the GAM it is 1.159198.\n\nConclusion:\n\nGiven its lower MSPE, the linear regression model (linearmodel) shows better prediction accuracy for the 'weight' variable within the test_data dataset. Hence, based on the MSPE metric, the linear model is the more suitable choice in this particular scenario.\n\nHowever, it is important to remember that evaluating models typically involves multiple criteria, and the selection of the most appropriate model may vary based on the specific objectives and the nature of the data involved.\n\nWith this blog post we have a given insight in how to preform a Linear Regression in RStudio\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","editor":"visual","theme":"cosmo","title-block-banner":true,"title":"Intro to Linear Regression in RStudio","author":"Abdul Khan","date":"2023-12-04","categories":["R","regression","code","analysis"],"image":"image.jpg"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}